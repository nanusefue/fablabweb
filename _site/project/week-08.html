<!DOCTYPE html>
<html>

    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/assets/ico/favicon.ico">

    <title>FAB ACADEMY 2017 - Embedded programming [8]</title>

    <!-- Bootstrap core CSS -->
    <link href="/assets/css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="/assets/css/style.css" rel="stylesheet">
    <link href="/assets/css/font-awesome.min.css" rel="stylesheet">
        <link href="/assets/css/syntax.css" rel="stylesheet">

    <!-- Custom CSS -->
    <!--<link rel="stylesheet" href="/css/main.css">-->


    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

    <body>
        <!-- Fixed navbar -->
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">FAB ACADEMY 2017</a>
    </div>
    <div class="navbar-collapse collapse navbar-right">
      <ul class="nav navbar-nav">
        <li ><a href="/">HOME</a></li>
      <!--  <li ><a href="/blog/">BLOG</a></li> -->
     <!--   <li ><a href="/portfolio/">PORTFOLIO</a></li> -->
        <li ><a href="/about/">ABOUT</a></li>
     <!--   <li ><a href="/contact/">CONTACT</a></li>-->
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</div>

            <div id="blue">
    <div class="container">
        <div class="row">
            <h3>Embedded programming [8]</h3>
        </div><!-- /row -->
    </div> <!-- /container -->
</div><!-- /blue -->

<div class="container mt">
    <div class="row">

        <div class="col-lg-10 col-lg-offset-1 centered">
    <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
        <!-- Indicators -->
        <ol class="carousel-indicators">
            
        </ol>

        <!-- Wrapper for slides -->
        <div class="carousel-inner">
            
            
        </div>
    </div> <!--/Carousel -->
</div>


        <div class="col-lg-10 col-lg-offset-1">
            <div class="spacing"></div>

            <h2>Assignment</h2>

<ul>
<li>
  <h3>Read a microcontroller data sheet.
</h3>
</li>
<li>
  <h3>Program your board to do something, with as many different programming languages and programming environments as possible.
</h3>
</li>
<li>
  <h3>Optionally, experiment with other architectures.</h3>
</li> 
</ul>

<p>
For this assignment began studying the Attiny family of Atmel processors. <a href="http://www.atmel.com/products/microcontrollers/avr/tinyavr.aspx" target="_blank">Attiny
</a></p>
<p>When we work with any electronic component, and more when it is a chip, all of them have their datasheet, these sheets give us the necessary information to be able to use them in any design we make, such as work voltages, currents, programming, arrangement of pins, size, etc.</p>

<div class="col-xs-12 ">
<img width="450px" src="/assets/img/project/week8/atmel.png" alt="webpage jekyll" />
<img width="450px" src="/assets/img/project/week8/atmel1.png" alt="webpage jekyll" />
</div>

<div class="col-xs-12 ">
<img width="450px" src="/assets/img/project/week8/atmel2.png" alt="webpage jekyll" />
<img width="450px" src="/assets/img/project/week8/atmel3.png" alt="webpage jekyll" />
</div>

<div class="col-xs-12 col-xs-offset-2 col-lg-10 col-lg-offset-2 ">
  <img width="650px" src="/assets/img/project/week8/atmel6.png" alt="webpage jekyll" />
</div>

<p>For this week I decided to investigate to be able to make my board have a bootloader as an arduino and be able to use the Arduino IDE.</p>
<p>In order to make my board use its own bootloader, I have found two projects that have served me for this, one is the v-usb project, which allows: <i>"V-USB is a software-only implementation of a low-speed USB device for Atmel's AVR® microcontrollers, making it possible to build USB hardware with almost any AVR® microcontroller, not requiring any additional chip. "</i> , and the other is a bootloader called Micronucleus:<i>"Micronucleus is a bootloader designed for AVR ATtiny microcontrollers with a minimal usb interface, cross platform libusb-based program upload tool, and a strong emphasis on bootloader compactness. To the authors knowledge this is, by far, the smallest USB bootloader for AVR ATtiny"</i>, in this case I have created a fork of the repository and I have modified the configuration to use the Attiny44 since it was not included.
<a target="_blank" href="https://github.com/nanusefue/micronucleus/tree/master/firmware/configuration/t44a_default">Modification Attiny44 </a></p>

<p>For this I will use a bootloader that I have modified and can be used with the attiny44, also it is necessary to know how the pins of the atiny are mapped with the pins of Arduino, here we see a picture of how this would be.</p>

<p>This allows me to upload all the code through the USB port without having to have 6 extra pins and the FABISP.</p>

<div class="col-xs-12 col-xs-offset-2 col-lg-10 col-lg-offset-2 ">
<img width="650px" src="/assets/img/project/week8/atmel5.png" alt="webpage jekyll" />
</div>

<p>The first program is a blink, to prove that everything works correctly.</p>
<p>the board includes an internal led as an arduino the difference is that it is internally connected to the PA0 pin.</p>
<div class="col-xs-12 col-xs-offset-2 col-lg-10 col-lg-offset-2 ">
<img width="550px" src="/assets/img/project/week8/led.png" alt="webpage jekyll" />
</div>

<div class="col-xs-12 ">



<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="code"><pre>	<span class="cm">/*   Blink */</span>
	<span class="c1">// the setup function runs once when you press reset or power the board
</span>	<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
	  <span class="c1">// initialize digital pin LED_BUILTIN as an output.
</span>	  <span class="n">pinMode</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="c1">// the loop function runs over and over again forever
</span>	<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
	  <span class="n">digitalWrite</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">HIGH</span><span class="p">);</span>   <span class="c1">// turn the LED on (HIGH is the voltage level)
</span>	  <span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>                       <span class="c1">// wait for a second
</span>	  <span class="n">digitalWrite</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">LOW</span><span class="p">);</span>    <span class="c1">// turn the LED off by making the voltage LOW
</span>	  <span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>                       <span class="c1">// wait for a second
</span>	<span class="p">}</span></pre></td></tr></tbody></table></code></pre></figure>

</div>
<p><br /></p>

<div class="col-xs-12 ">

<video width="800" controls="" loop="">
  <source src="/assets/img/project/week8/video.mp4" type="video/mp4" />
  Your browser does not support HTML5 video.
</video>
</div>
<p>The second program used the library to control servo motor, basically with this board we can use almost all libraries of arduino, the only problem is the space that is available to our programs, as the 44 attiny is only 4k.</p>
<p>So that our plate can control a servo motor we can follow the connections that we see in the superior image, gnd, 5volts and the pin PA1 that is in charge of controlling it.</p>
<p><br /></p>

<div class="col-xs-12 col-xs-offset-2 col-lg-10 col-lg-offset-2 ">
<img width="650px" src="/assets/img/project/week8/block.png" alt="webpage jekyll" />
</div>

<div class="col-xs-12 ">


<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="code"><pre><span class="cp">#include &lt;SoftRcPulseOut.h&gt; 
</span> 
<span class="n">SoftRcPulseOut</span> <span class="n">myservo</span><span class="p">;</span>  <span class="c1">// create servo object to control a servo 
</span>                        <span class="c1">// a maximum of eight servo objects can be created 
</span><span class="cp">#define SERVO_PIN         9
</span>
<span class="cp">#define REFRESH_PERIOD_MS 1
</span>
<span class="cp">#define NOW               1
</span>
<span class="kt">int</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    <span class="c1">// variable to store the servo position 
</span> 
<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> 
<span class="p">{</span> 
  <span class="n">myservo</span><span class="p">.</span><span class="n">attach</span><span class="p">(</span><span class="n">SERVO_PIN</span><span class="p">);</span>  <span class="c1">// attaches the servo on pin defined by SERVO_PIN to the servo object 
</span><span class="p">}</span> 
 
 
<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> 
<span class="p">{</span> 
  <span class="k">for</span><span class="p">(</span><span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">180</span><span class="p">;</span> <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1">// goes from 0 degrees to 180 degrees 
</span>  <span class="p">{</span>                                  <span class="c1">// in steps of 1 degree 
</span>    <span class="n">myservo</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span>              <span class="c1">// tell servo to go to position in variable 'pos' 
</span>    <span class="n">delay</span><span class="p">(</span><span class="n">REFRESH_PERIOD_MS</span><span class="p">);</span>        <span class="c1">// waits 20ms for refresh period 
</span>    <span class="n">SoftRcPulseOut</span><span class="o">::</span><span class="n">refresh</span><span class="p">(</span><span class="n">NOW</span><span class="p">);</span>    <span class="c1">// generates the servo pulse Now
</span>  <span class="p">}</span> 
  <span class="k">for</span><span class="p">(</span><span class="n">pos</span> <span class="o">=</span> <span class="mi">180</span><span class="p">;</span> <span class="n">pos</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">;</span> <span class="n">pos</span><span class="o">-=</span><span class="mi">1</span><span class="p">)</span>     <span class="c1">// goes from 180 degrees to 0 degrees 
</span>  <span class="p">{</span>                                
    <span class="n">myservo</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span>              <span class="c1">// tell servo to go to position in variable 'pos' 
</span>    <span class="n">delay</span><span class="p">(</span><span class="n">REFRESH_PERIOD_MS</span><span class="p">);</span>        <span class="c1">// waits 20ms for for refresh period 
</span>    <span class="n">SoftRcPulseOut</span><span class="o">::</span><span class="n">refresh</span><span class="p">(</span><span class="n">NOW</span><span class="p">);</span>    <span class="c1">// generates the servo pulse Now
</span>  <span class="p">}</span> 
<span class="p">}</span> </pre></td></tr></tbody></table></code></pre></figure>

</div>

<div class="col-xs-12 ">

<video width="800" controls="" loop="">
  <source src="/assets/img/project/week8/servo.mp4" type="video/mp4" />
  Your browser does not support HTML5 video.
</video>
</div>
<h4>C and Attiny44</h4>
<p>To compile the micronucleous application that is responsible for connecting the computer to our pcb, we use the make command, this compile for our system and architecture type, then we can copy the result to the folder / <i>"usr/local/bin"</i>, and we can access this from anywhere in our console.</p>
<div class="col-xs-12 ">


<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre>  ~ <span class="nv">$ </span>make 
      Building library: micronucleus_lib...
      gcc  <span class="nt">-L</span>/usr/lib/x86_64-linux-gnu <span class="nt">-lusb</span> <span class="nt">-Ilibrary</span> <span class="nt">-O</span> <span class="nt">-g</span> <span class="nt">-D</span> LINUX <span class="nt">-c</span> library/micronucleus_lib.c
      Building library: littleWire_util...
      gcc  <span class="nt">-L</span>/usr/lib/x86_64-linux-gnu <span class="nt">-lusb</span> <span class="nt">-Ilibrary</span> <span class="nt">-O</span> <span class="nt">-g</span> <span class="nt">-D</span> LINUX <span class="nt">-c</span> library/littleWire_util.c
      Building <span class="nb">command </span>line tool: micronucleus...
      gcc  <span class="nt">-L</span>/usr/lib/x86_64-linux-gnu <span class="nt">-lusb</span> <span class="nt">-Ilibrary</span> <span class="nt">-O</span> <span class="nt">-g</span> <span class="nt">-D</span> LINUX <span class="nt">-o</span> micronucleus micronucleus.c
       micronucleus_lib.o littleWire_util.o <span class="nt">-L</span>/usr/lib/x86_64-linux-gnu <span class="nt">-lusb</span>
  ~ <span class="nv">$ </span><span class="nb">sudo </span>cp micronucleus /usr/local/bin/
  ~ <span class="nv">$ </span>micronucleus 
      usage: micronucleus <span class="o">[</span><span class="nt">--help</span><span class="o">]</span> <span class="o">[</span><span class="nt">--run</span><span class="o">]</span> <span class="o">[</span><span class="nt">--dump-progress</span><span class="o">]</span> <span class="o">[</span><span class="nt">--fast-mode</span><span class="o">]</span> 
      <span class="o">[</span><span class="nt">--type</span> intel-hex|raw] <span class="o">[</span><span class="nt">--timeout</span> integer] <span class="o">[</span><span class="nt">--erase-only</span><span class="o">]</span> filename <span class="o">[</span><span class="nt">--no-ansi</span><span class="o">]</span></pre></td></tr></tbody></table></code></pre></figure>


<br />
</div>
<p>Blink in C</p>
<div class="col-xs-12 ">


<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="code"><pre><span class="cp">#include &lt;avr/io.h&gt;
#include &lt;util/delay.h&gt;
</span> 
<span class="kt">int</span> <span class="nf">main</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// set PA0 to be output
</span>  <span class="n">DDRA</span> <span class="o">=</span> <span class="mi">0</span><span class="n">b00000001</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    
    <span class="c1">// flash# 1:
</span>    <span class="c1">// set PA0 high
</span>    <span class="n">PORTA</span> <span class="o">=</span> <span class="mi">0</span><span class="n">b00000001</span><span class="p">;</span> 
    <span class="n">_delay_ms</span><span class="p">(</span><span class="mi">90</span><span class="p">);</span>
    <span class="c1">// set PA0 low
</span>    <span class="n">PORTA</span> <span class="o">=</span> <span class="mi">0</span><span class="n">b00000000</span><span class="p">;</span>
    <span class="n">_delay_ms</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span>
    
    <span class="p">}</span>
 
  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span></pre></td></tr></tbody></table></code></pre></figure>

<br />
<p>I use a modification of the Niels Make file, to create the .hex file of our program.</p>
</div>
<div class="col-xs-12 ">


<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
</pre></td><td class="code"><pre><span class="cp"># Name: Makefile
# Project: custom-class example
# Author: Christian Starkjohann
# Creation Date: 2008-04-07
# Tabsize: 4
# Copyright: (c) 2008 by OBJECTIVE DEVELOPMENT Software GmbH
# License: GNU GPL v2 (see License.txt), GNU GPL v3 or proprietary (CommercialLicense.txt)
# This Revision: $Id: Makefile 692 2008-11-07 15:07:40Z cs $
</span>
<span class="n">DEVICE</span>  <span class="o">=</span> <span class="n">attiny44</span>
<span class="cp">#F_CPU   = 12000000	# in Hz
</span><span class="n">F_CPU</span>   <span class="o">=</span> <span class="mi">16000000</span>	<span class="err">#</span> <span class="n">in</span> <span class="n">Hz</span>
<span class="n">FUSE_L</span>  <span class="o">=</span> <span class="mh">0xE2</span>
<span class="n">FUSE_H</span>  <span class="o">=</span> <span class="mh">0xDD</span>
<span class="cp">#AVRDUDE = avrdude -c usbtiny -p $(DEVICE) -D -F # edit this line for your programmer
#AVRDUDE = avrdude -c avrisp2 -p $(DEVICE) # edit this line for your programmer
</span><span class="n">AVRDUDE</span> <span class="o">=</span> <span class="n">avrdude</span> <span class="o">-</span><span class="n">c</span> <span class="n">atmelice_isp</span> <span class="o">-</span><span class="n">p</span> <span class="err">$</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span> <span class="err">#</span> <span class="n">edit</span> <span class="k">this</span> <span class="n">line</span> <span class="k">for</span> <span class="n">your</span> <span class="n">programmer</span>


<span class="n">CFLAGS</span>  <span class="o">=</span> <span class="o">-</span><span class="n">DDEBUG_LEVEL</span><span class="o">=</span><span class="mi">0</span>
<span class="n">OBJECTS</span> <span class="o">=</span><span class="n">main</span><span class="p">.</span><span class="n">o</span>

<span class="n">COMPILE</span> <span class="o">=</span> <span class="n">avr</span><span class="o">-</span><span class="n">gcc</span> <span class="o">-</span><span class="n">Wall</span> <span class="o">-</span><span class="n">Os</span> <span class="o">-</span><span class="n">DF_CPU</span><span class="o">=</span><span class="err">$</span><span class="p">(</span><span class="n">F_CPU</span><span class="p">)</span> <span class="err">$</span><span class="p">(</span><span class="n">CFLAGS</span><span class="p">)</span> <span class="o">-</span><span class="n">mmcu</span><span class="o">=</span><span class="err">$</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>

<span class="cp"># symbolic targets:
</span><span class="n">help</span><span class="o">:</span>
	<span class="err">@</span><span class="n">echo</span> <span class="s">"This Makefile has no default rule. Use one of the following:"</span>
	<span class="err">@</span><span class="n">echo</span> <span class="s">"make hex ....... to build main.hex"</span>
	<span class="err">@</span><span class="n">echo</span> <span class="s">"make clean ..... to delete objects and hex file"</span>

<span class="n">hex</span><span class="o">:</span> <span class="n">main</span><span class="p">.</span><span class="n">hex</span>

<span class="cp"># rule for deleting dependent files (those which can be built by Make):
</span><span class="n">clean</span><span class="o">:</span>
	<span class="n">rm</span> <span class="o">-</span><span class="n">f</span> <span class="n">main</span><span class="p">.</span><span class="n">hex</span> <span class="n">main</span><span class="p">.</span><span class="n">lst</span> <span class="n">main</span><span class="p">.</span><span class="n">obj</span> <span class="n">main</span><span class="p">.</span><span class="n">cof</span> <span class="n">main</span><span class="p">.</span><span class="n">list</span> <span class="n">main</span><span class="p">.</span><span class="n">map</span> <span class="n">main</span><span class="p">.</span><span class="n">eep</span><span class="p">.</span><span class="n">hex</span> <span class="n">main</span><span class="p">.</span><span class="n">elf</span> <span class="o">*</span><span class="p">.</span><span class="n">o</span> <span class="n">usbdrv</span><span class="o">/*</span><span class="p">.</span><span class="n">o</span> <span class="n">main</span><span class="p">.</span><span class="n">s</span> <span class="n">usbdrv</span><span class="o">/</span><span class="n">oddebug</span><span class="p">.</span><span class="n">s</span> <span class="n">usbdrv</span><span class="o">/</span><span class="n">usbdrv</span><span class="p">.</span><span class="n">s</span>

<span class="cp"># Generic rule for compiling C files:
</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="n">o</span><span class="o">:</span>
	<span class="err">$</span><span class="p">(</span><span class="n">COMPILE</span><span class="p">)</span> <span class="o">-</span><span class="n">c</span> <span class="err">$</span><span class="o">&lt;</span> <span class="o">-</span><span class="n">o</span> <span class="err">$@</span>

<span class="cp"># Generic rule for assembling Assembler source files:
</span><span class="p">.</span><span class="n">S</span><span class="p">.</span><span class="n">o</span><span class="o">:</span>
	<span class="err">$</span><span class="p">(</span><span class="n">COMPILE</span><span class="p">)</span> <span class="o">-</span><span class="n">x</span> <span class="n">assembler</span><span class="o">-</span><span class="n">with</span><span class="o">-</span><span class="n">cpp</span> <span class="o">-</span><span class="n">c</span> <span class="err">$</span><span class="o">&lt;</span> <span class="o">-</span><span class="n">o</span> <span class="err">$@</span>
<span class="cp"># "-x assembler-with-cpp" should not be necessary since this is the default
# file type for the .S (with capital S) extension. However, upper case
# characters are not always preserved on Windows. To ensure WinAVR
# compatibility define the file type manually.
</span>
<span class="cp"># Generic rule for compiling C to assembler, used for debugging only.
</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="n">s</span><span class="o">:</span>
	<span class="err">$</span><span class="p">(</span><span class="n">COMPILE</span><span class="p">)</span> <span class="o">-</span><span class="n">S</span> <span class="err">$</span><span class="o">&lt;</span> <span class="o">-</span><span class="n">o</span> <span class="err">$@</span>

<span class="cp"># file targets:
</span>
<span class="cp"># Since we don't want to ship the driver multipe times, we copy it into this project:
</span><span class="n">usbdrv</span><span class="o">:</span>
<span class="cp">#	cp -r ../../../usbdrv .
</span>
<span class="n">main</span><span class="p">.</span><span class="n">elf</span><span class="o">:</span> <span class="n">usbdrv</span> <span class="err">$</span><span class="p">(</span><span class="n">OBJECTS</span><span class="p">)</span>	<span class="err">#</span> <span class="n">usbdrv</span> <span class="n">dependency</span> <span class="n">only</span> <span class="n">needed</span> <span class="n">because</span> <span class="n">we</span> <span class="n">copy</span> <span class="n">it</span>
	<span class="err">$</span><span class="p">(</span><span class="n">COMPILE</span><span class="p">)</span> <span class="o">-</span><span class="n">o</span> <span class="n">main</span><span class="p">.</span><span class="n">elf</span> <span class="err">$</span><span class="p">(</span><span class="n">OBJECTS</span><span class="p">)</span>

<span class="n">main</span><span class="p">.</span><span class="n">hex</span><span class="o">:</span> <span class="n">main</span><span class="p">.</span><span class="n">elf</span>
	<span class="n">rm</span> <span class="o">-</span><span class="n">f</span> <span class="n">main</span><span class="p">.</span><span class="n">hex</span> <span class="n">main</span><span class="p">.</span><span class="n">eep</span><span class="p">.</span><span class="n">hex</span>
	<span class="n">avr</span><span class="o">-</span><span class="n">objcopy</span> <span class="o">-</span><span class="n">j</span> <span class="p">.</span><span class="n">text</span> <span class="o">-</span><span class="n">j</span> <span class="p">.</span><span class="n">data</span> <span class="o">-</span><span class="n">O</span> <span class="n">ihex</span> <span class="n">main</span><span class="p">.</span><span class="n">elf</span> <span class="n">main</span><span class="p">.</span><span class="n">hex</span>
	<span class="n">avr</span><span class="o">-</span><span class="n">size</span> <span class="n">main</span><span class="p">.</span><span class="n">hex</span></pre></td></tr></tbody></table></code></pre></figure>

<br />

</div>
<p>Make command Help </p>
<div class="col-xs-12 ">


<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="code"><pre> <span class="n">make</span>
<span class="n">This</span> <span class="n">Makefile</span> <span class="n">has</span> <span class="n">no</span> <span class="k">default</span> <span class="n">rule</span><span class="p">.</span> <span class="n">Use</span> <span class="n">one</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span><span class="o">:</span>
<span class="n">make</span> <span class="n">hex</span> <span class="p">.......</span> <span class="n">to</span> <span class="n">build</span> <span class="n">main</span><span class="p">.</span><span class="n">hex</span>
<span class="n">make</span> <span class="n">clean</span> <span class="p">.....</span> <span class="n">to</span> <span class="k">delete</span> <span class="n">objects</span> <span class="n">and</span> <span class="n">hex</span> <span class="n">file</span></pre></td></tr></tbody></table></code></pre></figure>

<br />
</div>
<p>Create .hex file</p>
<div class="col-xs-12 ">


<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre><span class="n">make</span> <span class="n">hex</span>
<span class="n">avr</span><span class="o">-</span><span class="n">gcc</span> <span class="o">-</span><span class="n">Wall</span> <span class="o">-</span><span class="n">Os</span> <span class="o">-</span><span class="n">DF_CPU</span><span class="o">=</span><span class="mi">16000000</span>	 <span class="o">-</span><span class="n">DDEBUG_LEVEL</span><span class="o">=</span><span class="mi">0</span> <span class="o">-</span><span class="n">mmcu</span><span class="o">=</span><span class="n">attiny44</span> <span class="o">-</span><span class="n">c</span> <span class="n">main</span><span class="p">.</span><span class="n">c</span> <span class="o">-</span><span class="n">o</span> <span class="n">main</span><span class="p">.</span><span class="n">o</span>
<span class="n">avr</span><span class="o">-</span><span class="n">gcc</span> <span class="o">-</span><span class="n">Wall</span> <span class="o">-</span><span class="n">Os</span> <span class="o">-</span><span class="n">DF_CPU</span><span class="o">=</span><span class="mi">16000000</span>	 <span class="o">-</span><span class="n">DDEBUG_LEVEL</span><span class="o">=</span><span class="mi">0</span> <span class="o">-</span><span class="n">mmcu</span><span class="o">=</span><span class="n">attiny44</span> <span class="o">-</span><span class="n">o</span> <span class="n">main</span><span class="p">.</span><span class="n">elf</span> <span class="n">main</span><span class="p">.</span><span class="n">o</span>
<span class="n">rm</span> <span class="o">-</span><span class="n">f</span> <span class="n">main</span><span class="p">.</span><span class="n">hex</span> <span class="n">main</span><span class="p">.</span><span class="n">eep</span><span class="p">.</span><span class="n">hex</span>
<span class="n">avr</span><span class="o">-</span><span class="n">objcopy</span> <span class="o">-</span><span class="n">j</span> <span class="p">.</span><span class="n">text</span> <span class="o">-</span><span class="n">j</span> <span class="p">.</span><span class="n">data</span> <span class="o">-</span><span class="n">O</span> <span class="n">ihex</span> <span class="n">main</span><span class="p">.</span><span class="n">elf</span> <span class="n">main</span><span class="p">.</span><span class="n">hex</span>
<span class="n">avr</span><span class="o">-</span><span class="n">size</span> <span class="n">main</span><span class="p">.</span><span class="n">hex</span>
   <span class="n">text</span>	   <span class="n">data</span>	    <span class="n">bss</span>	    <span class="n">dec</span>	    <span class="n">hex</span>	<span class="n">filename</span>
      <span class="mi">0</span>	    <span class="mi">102</span>	      <span class="mi">0</span>	    <span class="mi">102</span>	     <span class="mi">66</span>	<span class="n">main</span><span class="p">.</span><span class="n">hex</span></pre></td></tr></tbody></table></code></pre></figure>

<br />
</div>
<p>Upload using Micronucleus program</p>
<div class="col-xs-12 ">


<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="code"><pre><span class="n">micronucleus</span> <span class="o">--</span><span class="n">run</span> <span class="n">main</span><span class="p">.</span><span class="n">hex</span> 
<span class="o">&gt;</span> <span class="n">Please</span> <span class="n">plug</span> <span class="n">in</span> <span class="n">the</span> <span class="n">device</span> <span class="p">...</span> 
<span class="o">&gt;</span> <span class="n">Press</span> <span class="n">CTRL</span><span class="o">+</span><span class="n">C</span> <span class="n">to</span> <span class="n">terminate</span> <span class="n">the</span> <span class="n">program</span><span class="p">.</span>
<span class="o">&gt;</span> <span class="n">Device</span> <span class="n">is</span> <span class="n">found</span><span class="o">!</span>
<span class="n">connecting</span><span class="o">:</span> <span class="mi">33</span><span class="o">%</span> <span class="n">complete</span>
<span class="o">&gt;</span> <span class="n">Device</span> <span class="n">has</span> <span class="n">firmware</span> <span class="n">version</span> <span class="mf">2.3</span>
<span class="o">&gt;</span> <span class="n">Device</span> <span class="n">signature</span><span class="o">:</span> <span class="mh">0x1e9207</span> 
<span class="o">&gt;</span> <span class="n">Available</span> <span class="n">space</span> <span class="k">for</span> <span class="n">user</span> <span class="n">applications</span><span class="o">:</span> <span class="mi">2554</span> <span class="n">bytes</span>
<span class="o">&gt;</span> <span class="n">Suggested</span> <span class="n">sleep</span> <span class="n">time</span> <span class="n">between</span> <span class="n">sending</span> <span class="n">pages</span><span class="o">:</span> <span class="mi">7</span><span class="n">ms</span>
<span class="o">&gt;</span> <span class="n">Whole</span> <span class="n">page</span> <span class="n">count</span><span class="o">:</span> <span class="mi">40</span>  <span class="n">page</span> <span class="n">size</span><span class="o">:</span> <span class="mi">64</span>
<span class="o">&gt;</span> <span class="n">Erase</span> <span class="n">function</span> <span class="n">sleep</span> <span class="n">duration</span><span class="o">:</span> <span class="mi">280</span><span class="n">ms</span>
<span class="n">parsing</span><span class="o">:</span> <span class="mi">50</span><span class="o">%</span> <span class="n">complete</span>
<span class="o">&gt;</span> <span class="n">Erasing</span> <span class="n">the</span> <span class="n">memory</span> <span class="p">...</span>
<span class="n">erasing</span><span class="o">:</span> <span class="mi">66</span><span class="o">%</span> <span class="n">complete</span>
<span class="o">&gt;</span> <span class="n">Starting</span> <span class="n">to</span> <span class="n">upload</span> <span class="p">...</span>
<span class="n">writing</span><span class="o">:</span> <span class="mi">83</span><span class="o">%</span> <span class="n">complete</span>
<span class="o">&gt;</span> <span class="n">Starting</span> <span class="n">the</span> <span class="n">user</span> <span class="n">app</span> <span class="p">...</span>
<span class="n">running</span><span class="o">:</span> <span class="mi">100</span><span class="o">%</span> <span class="n">complete</span>
<span class="o">&gt;&gt;</span> <span class="n">Micronucleus</span> <span class="n">done</span><span class="p">.</span> <span class="n">Thank</span> <span class="n">you</span><span class="o">!</span></pre></td></tr></tbody></table></code></pre></figure>

</div>

<h3>Referens</h3>

<p><a href="http://academy.cba.mit.edu/classes/embedded_programming/doc8183.pdf">Attiny 44/84</a></p>
<p><a href="https://github.com/nanusefue/micronucleus">Micronucleus</a></p>
<p><a href="https://www.obdev.at/products/vusb/index.html">V-USB</a></p>
<p><a href="https://learn.adafruit.com/add-boards-arduino-v164/overview">Adding third party boards Arduino IDE</a></p>

<!--<h3>Download</h3>-->



        </div>
      <!--  <div class="col-lg-4 col-lg-offset-1">
            <div class="spacing"></div>
            <h4>Project Details</h4>
            <div class="hline"></div>
            <p><b>Date:</b> Jan 30, 2017</p>
            <p><b>Author:</b> Marcel Newman</p>
            <p><b>Categories:</b> project</p>
            <p><b>Tagged:</b> Flat, UI, Development</p>
            <p><b>Client:</b> Wonder Corp.</p>
            <p><b>Website:</b> <a href="http://blacktie.co">http://blacktie.co</a></p> 
        </div>-->
    </div><! --/row -->
</div><! --/container -->
	 
<div id="portfoliowrap">
    <div class="portfolio-centered">
        <h3></h3>
        <div class="recentitems portfolio">
            
        </div>
    </div>
</div> 


        <div id="footerwrap">
    <div class="container">
        <div class="row">
           <!-- <div class="col-lg-4">
                <h4>About</h4>
                <div class="hline-w"></div>
                <p></p>
            </div> -->
            <div class="col-lg-4">
                <p>
                    
                        <a target="_blank" href="https://github.com/nanusefue" class="btn-social btn-outline"><i class="fa fa-github"></i></a>
                    
                        <a target="_blank" href="https://www.instagram.com/nanusefue/" class="btn-social btn-outline"><i class="fa fa-instagram"></i></a>
                    
                </p>
            </div>
            <div class="col-lg-8" style="color:white">
                <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
                    <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a>
                    <br />This work is licensed under a 
                    <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>
     
            </div> 
        </div><! --/row -->
    </div><! --/container -->
</div><! --/footerwrap -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="/assets/js/bootstrap.min.js"></script>
<script src="/assets/js/retina-1.1.0.js"></script>
<script src="/assets/js/jquery.hoverdir.js"></script>
<script src="/assets/js/jquery.hoverex.min.js"></script>
<script src="/assets/js/jquery.prettyPhoto.js"></script>
<script src="/assets/js/jquery.isotope.min.js"></script>
<script src="/assets/js/custom.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-90860442-1', 'auto');
  ga('send', 'pageview');

</script>

<script>
// Portfolio
(function($) {
	"use strict";
	var $container = $('.portfolio'),
		$items = $container.find('.portfolio-item'),
		portfolioLayout = 'fitRows';
		
		if( $container.hasClass('portfolio-centered') ) {
			portfolioLayout = 'masonry';
		}
				
		$container.isotope({
			filter: '*',
			animationEngine: 'best-available',
			layoutMode: portfolioLayout,
			animationOptions: {
			duration: 750,
			easing: 'linear',
			queue: false
		},
		masonry: {
		}
		}, refreshWaypoints());
		
		function refreshWaypoints() {
			setTimeout(function() {
			}, 1000);   
		}
				
		$('nav.portfolio-filter ul a').on('click', function() {
				var selector = $(this).attr('data-filter');
				$container.isotope({ filter: selector }, refreshWaypoints());
				$('nav.portfolio-filter ul a').removeClass('active');
				$(this).addClass('active');
				return false;
		});
		
		function getColumnNumber() { 
			var winWidth = $(window).width(), 
			columnNumber = 1;
		
			if (winWidth > 1200) {
				columnNumber = 5;
			} else if (winWidth > 950) {
				columnNumber = 4;
			} else if (winWidth > 600) {
				columnNumber = 3;
			} else if (winWidth > 400) {
				columnNumber = 2;
			} else if (winWidth > 250) {
				columnNumber = 1;
			}
				return columnNumber;
			}       
			
			function setColumns() {
				var winWidth = $(window).width(), 
				columnNumber = getColumnNumber(), 
				itemWidth = Math.floor(winWidth / columnNumber);
				
				$container.find('.portfolio-item').each(function() { 
					$(this).css( { 
					width : itemWidth + 'px' 
				});
			});
		}
		
		function setPortfolio() { 
			setColumns();
			$container.isotope('reLayout');
		}
			
		$container.imagesLoaded(function () { 
			setPortfolio();
		});
		
		$(window).on('resize', function () { 
		setPortfolio();          
	});
})(jQuery);
</script>
    </body>
</html>