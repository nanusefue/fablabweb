<!DOCTYPE html>
<html>

    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/archives/2017/fablabbcn/students/271/assets/ico/favicon.ico">

    <title>FAB ACADEMY 2017 - Electronics production [4]</title>

    <!-- Bootstrap core CSS -->
    <link href="/archives/2017/fablabbcn/students/271/assets/css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="/archives/2017/fablabbcn/students/271/assets/css/style.css" rel="stylesheet">
    <link href="/archives/2017/fablabbcn/students/271/assets/css/font-awesome.min.css" rel="stylesheet">
        <link href="/archives/2017/fablabbcn/students/271/assets/css/syntax.css" rel="stylesheet">

    <!-- Custom CSS -->
    <!--<link rel="stylesheet" href="/archives/2017/fablabbcn/students/271/css/main.css">-->


    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

    <body>
        <!-- Fixed navbar -->
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/archives/2017/fablabbcn/students/271/">FAB ACADEMY 2017</a>
    </div>
    <div class="navbar-collapse collapse navbar-right">
      <ul class="nav navbar-nav">
        <li ><a href="/archives/2017/fablabbcn/students/271/">HOME</a></li>
      <!--  <li ><a href="/archives/2017/fablabbcn/students/271/blog/">BLOG</a></li> -->
     <!--   <li ><a href="/archives/2017/fablabbcn/students/271/portfolio/">PORTFOLIO</a></li> -->
        <li ><a href="/archives/2017/fablabbcn/students/271/about/">ABOUT</a></li>
     <!--   <li ><a href="/archives/2017/fablabbcn/students/271/contact/">CONTACT</a></li>-->
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</div>

            <div id="blue">
    <div class="container">
        <div class="row">
            <h3>Electronics production [4]</h3>
        </div><!-- /row -->
    </div> <!-- /container -->
</div><!-- /blue -->

<div class="container mt">
    <div class="row">

        <div class="col-lg-10 col-lg-offset-1 centered">
    <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
        <!-- Indicators -->
        <ol class="carousel-indicators">
            
        </ol>

        <!-- Wrapper for slides -->
        <div class="carousel-inner">
            
            
        </div>
    </div> <!--/Carousel -->
</div>


        <div class="col-lg-10 col-lg-offset-1">
            <div class="spacing"></div>

            <h2>Assignment</h2>
<ul>
<li>
	<h3>Make an in-circuit programmer by milling the PCB</h3>
</li>	
<li>
	<h3>Optionally trying other processes.</h3>
</li>
</ul>

<h2>Make an in-circuit programmer by milling the PCB</h2>

<p>
This week work to make an own FABISP, this board is very useful.
When creating any new board with any microcontroller  (avr family), normally you need load some program inside, the fabisp is a board to make this be a possibility.
Only you need to connect the fabsip in your computer and run the specific command to program the new board. 
</p>
<p>From the different design of the FABISP, I have decided to make several formats, the version with a mini usb connector and the version with the usb connector on the board, which uses fewer components. from the two png file cutting and paths, I used the fabmodules version to create the file for the cnc that we use in the fablab.</p>

<div class="col-xs-12 ">
<img width="300px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/hello.ISP.44.interior.png" alt="webpage jekyll" />
<img width="300px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/hello.ISP.44.traces.png" alt="webpage jekyll" />
<img width="300px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/hello.ISP.44.png" alt="webpage jekyll" />
</div>

<p>
configuration of fabmodules, we must create two files for this plate, one that corresponds to the external cut and another one for the creation of the traces of our board.
Import:
for both files we select the type of file that we are going to import (png), that must have a minimum resolution of 600dpi
Output format:
Roland mill (.rml) that is the format that accepts our cnc<p>
<ul>
<li>Traces:</li>
<ul>
<li><strong>PCB traces (1/64)</strong></li>
<li>PCB outline (1/32)</li>
<li>PCB traces (0.010)</li>
<li>wax rough cut (1/8)</li>
<li>wax finish cut (1/8)</li>
</ul>
</ul>

 
<ul>
<li>Outline:</li>
<ul>
<li>PCB traces (1/64)</li>
<li><strong>PCB outline (1/32)</strong></li>
<li>PCB traces (0.010)</li>
<li>wax rough cut (1/8)</li>
<li>wax finish cut (1/8)</li>
</ul>
</ul>
<h4>Cuts configurations
</h4>

<ul>
<li><strong>Outline:</strong></li>
<ul>
<li>machine: SMR-20</li>   
<li>x0 (mm): 0</li>
<li>y0 (mm): 0</li>
<li>z0 (mm): 0</li>
<li>xhome (mm): 0</li>
<li>yhome (mm): 0</li>
<li>zhome (mm): 10</li>	
</ul>
</ul>

<ul>
<li><strong>Process: (THIS CHANGES DEPEND IS IF TRACE OR OUTLINE)</strong></li>
<ul>
<li>cut depth (mm): 0.6</li>
<li>stock thickness (mm): 1.7</li>
<li>tool diameter (mm): 0.79</li> 
<li>number of offsets (-1 to fill): 1</li> 	
</ul>

</ul>

<div class="col-xs-12">

<img width="900px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/programerusb1.png" alt="webpage jekyll" />
</div>

<div class="col-xs-12">

<img width="900px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/programerusb3.png" alt="webpage jekyll" />
</div>


<p>Save .rml file</p>

<h4>Cutting in SMR-20 vPanel</h4>

<p>Before sending to cut our table is necessary to fix it in the platform of the machine, for this is used double-sided tape, since it is perfectly adapted to the platform and allows us to remove it without any difficulty when finished cutting the plate.</p>

<p>This is the control panel that we will use to configure the machine and send the files to our boards.</p>

<div class="col-xs-12 col-xs-offset-2 col-lg-10 col-lg-offset-2 ">
<img width="600px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/srm20-1.png" alt="webpage jekyll" />
</div>


<div class="col-xs-12  ">
<img width="900px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/srm20-3.png" alt="webpage jekyll" />
</div>
<div class="col-xs-12  ">
<img width="900px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/srm20-4.png" alt="webpage jekyll" />
</div>

<h4>Configure file in SMR-20 vPanel (CUT)</h4>

<div class="col-xs-12  ">
<img width="900px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/srm20-5.png" alt="webpage jekyll" />
</div>
<div class="col-xs-12  ">
<img width="900px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/srm20-6.png" alt="webpage jekyll" />
</div>

<h4>Set the Origin Point (XYZ)</h4>

<p>The X and Y origins are determined by the cutting data and the location of
the material. (“X” and “Y” cannot be set individually.) You normally align
the Z origin with the surface of the material. Take the size of the material
and the length of the cutting tool into consideration when you set the
origins.</p>

<div class="col-xs-12">

<img width="450px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/srm-xy.png" alt="webpage jekyll" />
<img width="400px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/srm_xy.png" alt="webpage jekyll" />
</div>


<div class="col-xs-12  ">
<img width="900px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/srm20-10.png" alt="webpage jekyll" />
</div>
<div class="col-xs-12  ">
<img width="900px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/srm20-11.png" alt="webpage jekyll" />
</div>

<div class="col-xs-12  ">
<img width="400px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/srm_yes.png" alt="webpage jekyll" />
<img width="400px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/srm_000.png" alt="webpage jekyll" />

</div>

<h4>Final Process</h4>

<div class="col-xs-12 ">

<img width="400px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/programer1.jpg" alt="webpage jekyll" />
<img width="400px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/programer.jpg" alt="webpage jekyll" />
</div>

<h4>UBS connector in pcb details</h4>

<div class="col-xs-12">

<img width="400px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/programer4.jpg" alt="webpage jekyll" />
<img width="400px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/programer3.jpg" alt="webpage jekyll" />
</div>
<h4>Programing board connections</h4>
<p>I work on linux and normally work with the design of boards, so I have already installed all the tools to work with microprocessors of the AVR family &lt;/ p&gt;
<p> But for anyone who wants to program their microcontrollore in linux you need to install some packages </p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>sudo apt-get install gcc-avr binutils-avr avr-libc

sudo apt-get install avrdude<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>


<br />

<div class="col-xs-12">

<img width="400px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/programer5.jpg" alt="webpage jekyll" />
<img width="400px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/programer6.jpg" alt="webpage jekyll" />
</div>

<h4>AVR Fuse</h4>
<p>
The fuse is a very important part when programming our microcontroller, an error in the fuse can leave to break of the own chip,
the fuses define how our chip should act, whether it has an external oscillator, the speed of the clock, whether it contains a bootloader, voltages and what it will work, protection to protect the program, etc.
The important thing about fuses is that they can be reset and changed constantly.
</p>
<p>
Each type of process has different fuse settings.
</p>



<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre></td><td class="code"><pre><span class="gp">nanu@nanu-ThinkPad-X220:firmware$ </span>make fuse
avrdude -c usbtiny -p attiny44  -U hfuse:w:0xDF:m -U lfuse:w:0xFF:m

avrdude: AVR device initialized and ready to accept instructions

Reading | <span class="c">################################################## | 100% 0.01s</span>

avrdude: Device signature <span class="o">=</span> 0x1e9207
avrdude: reading input file <span class="s2">"0xDF"</span>
avrdude: writing hfuse <span class="o">(</span>1 bytes<span class="o">)</span>:

Writing | <span class="c">################################################## | 100% 0.00s</span>

avrdude: 1 bytes of hfuse written
avrdude: verifying hfuse memory against 0xDF:
avrdude: load data hfuse data from input file 0xDF:
avrdude: input file 0xDF contains 1 bytes
avrdude: reading on-chip hfuse data:

Reading | <span class="c">################################################## | 100% 0.00s</span>

avrdude: verifying ...
avrdude: 1 bytes of hfuse verified
avrdude: reading input file <span class="s2">"0xFF"</span>
avrdude: writing lfuse <span class="o">(</span>1 bytes<span class="o">)</span>:

Writing | <span class="c">################################################## | 100% 0.01s</span>

avrdude: 1 bytes of lfuse written
avrdude: verifying lfuse memory against 0xFF:
avrdude: load data lfuse data from input file 0xFF:
avrdude: input file 0xFF contains 1 bytes
avrdude: reading on-chip lfuse data:

Reading | <span class="c">################################################## | 100% 0.00s</span>

avrdude: verifying ...
avrdude: 1 bytes of low fuse verified

avrdude: safemode: Fuses OK

avrdude <span class="k">done</span>.  Thank you.<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>


<h4>Programing</h4>

<p>
To program the chip with the firmware the "make" command is used, this command allows us to create different configurations depending on what we want to do to our chip.
like for example to record the fuse, to compile/recompile the code, etc. thus configuring this file we can indicate the family of the chip and the programmer to be used.
the -c flag is used to indicate the programmer and the -p family to which the chip belongs.

</p>


<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76</pre></td><td class="code"><pre><span class="gp">nanu@nanu-ThinkPad-X220:firmware$ </span>make program
avrdude -c usbtiny -p attiny44  -U flash:w:main.hex:i

avrdude: AVR device initialized and ready to accept instructions

Reading | <span class="c">################################################## | 100% 0.01s</span>

avrdude: Device signature <span class="o">=</span> 0x1e9207
avrdude: NOTE: FLASH memory has been specified, an erase cycle will be performed
         To disable this feature, specify the -D option.
avrdude: erasing chip
avrdude: reading input file <span class="s2">"main.hex"</span>
avrdude: writing flash <span class="o">(</span>2020 bytes<span class="o">)</span>:

Writing | <span class="c">################################################## | 100% 5.68s</span>



avrdude: 2020 bytes of flash written
avrdude: verifying flash memory against main.hex:
avrdude: load data flash data from input file main.hex:
avrdude: input file main.hex contains 2020 bytes
avrdude: reading on-chip flash data:

Reading | <span class="c">################################################## | 100% 3.36s</span>



avrdude: verifying ...
avrdude: 2020 bytes of flash verified

avrdude: safemode: Fuses OK

avrdude <span class="k">done</span>.  Thank you.

avrdude -c usbtiny -p attiny44  -U hfuse:w:0xDF:m -U lfuse:w:0xFF:m

avrdude: AVR device initialized and ready to accept instructions

Reading | <span class="c">################################################## | 100% 0.01s</span>

avrdude: Device signature <span class="o">=</span> 0x1e9207
avrdude: reading input file <span class="s2">"0xDF"</span>
avrdude: writing hfuse <span class="o">(</span>1 bytes<span class="o">)</span>:

Writing | <span class="c">################################################## | 100% 0.00s</span>

avrdude: 1 bytes of hfuse written
avrdude: verifying hfuse memory against 0xDF:
avrdude: load data hfuse data from input file 0xDF:
avrdude: input file 0xDF contains 1 bytes
avrdude: reading on-chip hfuse data:

Reading | <span class="c">################################################## | 100% 0.00s</span>

avrdude: verifying ...
avrdude: 1 bytes of hfuse verified
avrdude: reading input file <span class="s2">"0xFF"</span>
avrdude: writing lfuse <span class="o">(</span>1 bytes<span class="o">)</span>:

Writing | <span class="c">################################################## | 100% 0.00s</span>

avrdude: 1 bytes of lfuse written
avrdude: verifying lfuse memory against 0xFF:
avrdude: load data lfuse data from input file 0xFF:
avrdude: input file 0xFF contains 1 bytes
avrdude: reading on-chip lfuse data:

Reading | <span class="c">################################################## | 100% 0.00s</span>

avrdude: verifying ...
avrdude: 1 bytes of lfuse verified

avrdude: safemode: Fuses OK

avrdude <span class="k">done</span>.  Thank you.<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>



<br />
<p>

To verify that our board works correctly simply connecting it to our computer and using the command linux:


<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="gp">nanu@nanu-ThinkPad-X220:firmware$ </span>lsusb<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>


we will see that our device will appear in the list, and we can start to record any microprocessor that uses the ISP protocol.
</p>
<div class="col-xs-12 ">

<img width="1200px" src="/archives/2017/fablabbcn/students/271/assets/img/project/week4/programerusb.png" alt="webpage jekyll" />
</div>
<h3>References</h3>

<p><a target="_blank" href="http://www.ladyada.net/learn/avr/fuses.html">AVR Fuse</a></p>
<p><a target="_blank" href="https://en.wikipedia.org/wiki/In-system_programming">ISP</a></p>
<p><a target="_blank" href="http://fabmodules.org/">Fabmodules</a></p>
<p><a target="_blank" href="http://www.nongnu.org/avrdude/">Avrdude</a></p>

<h3>Download</h3>
<p><a href="/archives/2017/fablabbcn/students/271/assets/img/project/week4/download/fabisp.zip">FabISP</a></p>
<p><a href="/archives/2017/fablabbcn/students/271/assets/img/project/week4/download/fabispmin45.zip">FabISP MINI </a></p>

<p><a target="_blank" href="/archives/2017/fablabbcn/students/271/assets/img/project/week4/srm-20.pdf"> SRM-20 Manual</a></p>


</p></p></p>


        </div>
      <!--  <div class="col-lg-4 col-lg-offset-1">
            <div class="spacing"></div>
            <h4>Project Details</h4>
            <div class="hline"></div>
            <p><b>Date:</b> Jan 28, 2017</p>
            <p><b>Author:</b> Esteban Martin Gimenez</p>
            <p><b>Categories:</b> project</p>
            <p><b>Tagged:</b> Flat, UI, Development</p>
            <p><b>Client:</b> Wonder Corp.</p>
            <p><b>Website:</b> <a href="http://blacktie.co">http://blacktie.co</a></p> 
        </div>-->
    </div><! --/row -->
</div><! --/container -->
	 
<div id="portfoliowrap">
    <div class="portfolio-centered">
        <h3></h3>
        <div class="recentitems portfolio">
            
        </div>
    </div>
</div> 


        <div id="footerwrap">
    <div class="container">
        <div class="row">
           <!-- <div class="col-lg-4">
                <h4>About</h4>
                <div class="hline-w"></div>
                <p></p>
            </div> -->
            <div class="col-lg-4">
                <p>
                    
                        <a target="_blank" href="https://github.com/nanusefue" class="btn-social btn-outline"><i class="fa fa-github"></i></a>
                    
                        <a target="_blank" href="https://www.instagram.com/nanusefue/" class="btn-social btn-outline"><i class="fa fa-instagram"></i></a>
                    
                </p>
            </div>
            <div class="col-lg-8" style="color:white">
                <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
                    <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a>
                    <br />This work is licensed under a 
                    <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>
     
            </div> 
        </div><! --/row -->
    </div><! --/container -->
</div><! --/footerwrap -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="/archives/2017/fablabbcn/students/271/assets/js/bootstrap.min.js"></script>
<script src="/archives/2017/fablabbcn/students/271/assets/js/retina-1.1.0.js"></script>
<script src="/archives/2017/fablabbcn/students/271/assets/js/jquery.hoverdir.js"></script>
<script src="/archives/2017/fablabbcn/students/271/assets/js/jquery.hoverex.min.js"></script>
<script src="/archives/2017/fablabbcn/students/271/assets/js/jquery.prettyPhoto.js"></script>
<script src="/archives/2017/fablabbcn/students/271/assets/js/jquery.isotope.min.js"></script>
<script src="/archives/2017/fablabbcn/students/271/assets/js/custom.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-90860442-1', 'auto');
  ga('send', 'pageview');

</script>

<script>
// Portfolio
(function($) {
	"use strict";
	var $container = $('.portfolio'),
		$items = $container.find('.portfolio-item'),
		portfolioLayout = 'fitRows';
		
		if( $container.hasClass('portfolio-centered') ) {
			portfolioLayout = 'masonry';
		}
				
		$container.isotope({
			filter: '*',
			animationEngine: 'best-available',
			layoutMode: portfolioLayout,
			animationOptions: {
			duration: 750,
			easing: 'linear',
			queue: false
		},
		masonry: {
		}
		}, refreshWaypoints());
		
		function refreshWaypoints() {
			setTimeout(function() {
			}, 1000);   
		}
				
		$('nav.portfolio-filter ul a').on('click', function() {
				var selector = $(this).attr('data-filter');
				$container.isotope({ filter: selector }, refreshWaypoints());
				$('nav.portfolio-filter ul a').removeClass('active');
				$(this).addClass('active');
				return false;
		});
		
		function getColumnNumber() { 
			var winWidth = $(window).width(), 
			columnNumber = 1;
		
			if (winWidth > 1200) {
				columnNumber = 5;
			} else if (winWidth > 950) {
				columnNumber = 4;
			} else if (winWidth > 600) {
				columnNumber = 3;
			} else if (winWidth > 400) {
				columnNumber = 2;
			} else if (winWidth > 250) {
				columnNumber = 1;
			}
				return columnNumber;
			}       
			
			function setColumns() {
				var winWidth = $(window).width(), 
				columnNumber = getColumnNumber(), 
				itemWidth = Math.floor(winWidth / columnNumber);
				
				$container.find('.portfolio-item').each(function() { 
					$(this).css( { 
					width : itemWidth + 'px' 
				});
			});
		}
		
		function setPortfolio() { 
			setColumns();
			$container.isotope('reLayout');
		}
			
		$container.imagesLoaded(function () { 
			setPortfolio();
		});
		
		$(window).on('resize', function () { 
		setPortfolio();          
	});
})(jQuery);
</script>
    </body>
</html>